{"version":3,"file":"vuex-lasting.modern.js","sources":["../node_modules/shvl/dist/shvl.mjs","../index.js"],"sourcesContent":["function t(t,r,e){return void 0===(t=(r.split?r.split(\".\"):r).reduce(function(t,r){return t&&t[r]},t))?e:t}function r(t,r,e,n){return!/^(__proto__|constructor|prototype)$/.test(r)&&((r=r.split?r.split(\".\"):r.slice(0)).slice(0,-1).reduce(function(t,r){return t[r]=t[r]||{}},t)[r.pop()]=e),t}export{t as get,r as set};\n//# sourceMappingURL=shvl.mjs.map\n","import * as shvl from \"shvl\";\n\nexport default function lasting(options = {}) {\n  return (store) => {\n    let { key, opt, paths = [] } = options;\n    key = key || \"lasting\";\n    opt = opt || {\n      set: (k, v) => {\n        try {\n          v = JSON.stringify(v);\n        } catch (err) {\n          console.warn(\"lasting set err:\", err);\n        }\n        return localStorage.setItem(`${key}-${k}`, v);\n      },\n      get: (k) => {\n        let v = localStorage.getItem(`${key}-${k}`);\n        try {\n          v = JSON.parse(v);\n        } catch (err) {\n          console.warn(\"lasting get err:\", err);\n        }\n        return v;\n      },\n      rm: (k) => {\n        return localStorage.removeItem(`${key}-${k}`);\n      }\n    };\n\n    for (let i = 0; i < paths.length; i++) {\n      const son = paths[i];\n      const sv = opt.get(son);\n      ( sv !== undefined && sv !== null ) && shvl.set(store.state, son, sv);\n      store.watch(\n        (state) => shvl.get(state, son),\n        (v) => {\n          opt.set(son, v);\n        }\n      );\n    }\n  };\n}\n"],"names":["t","r","e","split","reduce","n","test","slice","pop","lasting","options","store","key","opt","paths","set","k","v","JSON","stringify","err","console","warn","localStorage","setItem","get","getItem","parse","rm","removeItem","i","length","son","sv","shvl","state","watch"],"mappings":"AAAA,SAASA,EAAEA,EAAEC,EAAEC,GAAG,YAAO,KAAUF,GAAGC,EAAEE,MAAMF,EAAEE,MAAM,KAAKF,GAAGG,OAAO,SAASJ,EAAEC,GAAG,OAAOD,GAAGA,EAAEC,IAAID,IAAIE,EAAEF,EAAE,SAASC,EAAED,EAAEC,EAAEC,EAAEG,GAAG,OAAO,sCAAsCC,KAAKL,MAAMA,EAAEA,EAAEE,MAAMF,EAAEE,MAAM,KAAKF,EAAEM,MAAM,IAAIA,MAAM,GAAG,GAAGH,OAAO,SAASJ,EAAEC,GAAG,OAAOD,EAAEC,GAAGD,EAAEC,IAAI,IAAID,GAAGC,EAAEO,OAAON,GAAGF,WCExQS,EAAQC,EAAU,IACxC,OAAQC,IACN,IAAIC,IAAEA,EAAFC,IAAOA,EAAPC,MAAYA,EAAQ,IAAOJ,EAC/BE,EAAMA,GAAO,UACbC,EAAMA,GAAO,CACXE,IAAK,CAACC,EAAGC,KACP,IACEA,EAAIC,KAAKC,UAAUF,GACnB,MAAOG,GACPC,QAAQC,KAAK,mBAAoBF,GAEnC,OAAOG,aAAaC,QAAS,GAAEZ,KAAOI,IAAKC,IAE7CQ,IAAMT,IACJ,IAAIC,EAAIM,aAAaG,QAAS,GAAEd,KAAOI,KACvC,IACEC,EAAIC,KAAKS,MAAMV,GACf,MAAOG,GACPC,QAAQC,KAAK,mBAAoBF,GAEnC,OAAOH,GAETW,GAAKZ,GACIO,aAAaM,WAAY,GAAEjB,KAAOI,MAI7C,IAAK,IAAIc,EAAI,EAAGA,EAAIhB,EAAMiB,OAAQD,IAAK,CACrC,MAAME,EAAMlB,EAAMgB,GACZG,EAAKpB,EAAIY,IAAIO,GACjBC,MAAAA,GAAqCC,EAASvB,EAAMwB,MAAOH,EAAKC,GAClEtB,EAAMyB,MACHD,GAAUD,EAASC,EAAOH,GAC1Bf,IACCJ,EAAIE,IAAIiB,EAAKf"}