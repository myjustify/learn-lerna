{"version":3,"file":"vuex-lasting.mjs","sources":["../index.js"],"sourcesContent":["import * as shvl from \"shvl\";\n\nexport default function lasting(options = {}) {\n  return (store) => {\n    let { key, opt, paths = [] } = options;\n    key = key || \"lasting\";\n    opt = opt || {\n      set: (k, v) => {\n        try {\n          v = JSON.stringify(v);\n        } catch (err) {\n          console.warn(\"lasting set err:\", err);\n        }\n        return localStorage.setItem(`${key}-${k}`, v);\n      },\n      get: (k) => {\n        let v = localStorage.getItem(`${key}-${k}`);\n        try {\n          v = JSON.parse(v);\n        } catch (err) {\n          console.warn(\"lasting get err:\", err);\n        }\n        return v;\n      },\n      rm: (k) => {\n        return localStorage.removeItem(`${key}-${k}`);\n      }\n    };\n\n    for (let i = 0; i < paths.length; i++) {\n      const son = paths[i];\n      const sv = opt.get(son);\n      sv && shvl.set(store.state, son, sv);\n      store.watch(\n        (state) => shvl.get(state, son),\n        (v) => {\n          opt.set(son, v);\n        }\n      );\n    }\n  };\n}\n"],"names":["lasting","options","store","key","opt","paths","set","k","v","JSON","stringify","err","console","warn","localStorage","setItem","get","getItem","parse","rm","removeItem","i","son","sv","shvl","state","watch","length"],"mappings":"gCAEwBA,EAAQC,GAC9B,gBAD8BA,IAAAA,EAAU,aAChCC,GACN,IAAMC,EAAyBF,EAAzBE,IAAKC,EAAoBH,EAApBG,MAAoBH,EAAfI,MAAAA,aAAQ,KACxBF,EAAMA,GAAO,UACbC,EAAMA,GAAO,CACXE,IAAK,SAACC,EAAGC,GACP,IACEA,EAAIC,KAAKC,UAAUF,GACnB,MAAOG,GACPC,QAAQC,KAAK,mBAAoBF,GAEnC,OAAOG,aAAaC,QAAWZ,MAAOI,EAAKC,IAE7CQ,IAAK,SAACT,GACJ,IAAIC,EAAIM,aAAaG,QAAWd,MAAOI,GACvC,IACEC,EAAIC,KAAKS,MAAMV,GACf,MAAOG,GACPC,QAAQC,KAAK,mBAAoBF,GAEnC,OAAOH,GAETW,GAAI,SAACZ,GACH,OAAOO,aAAaM,WAAcjB,MAAOI,KAI7C,IA1BgB,eA0BPc,GACP,IAAMC,EAAMjB,EAAMgB,GACZE,EAAKnB,EAAIY,IAAIM,GACnBC,GAAMC,EAAKlB,IAAIJ,EAAMuB,MAAOH,EAAKC,GACjCrB,EAAMwB,MACJ,SAACD,UAAUD,EAAKR,IAAIS,EAAOH,IAC3B,SAACd,GACCJ,EAAIE,IAAIgB,EAAKd,MAPVa,EAAI,EAAGA,EAAIhB,EAAMsB,OAAQN,MAAzBA"}